language: java
dist: trusty
addons:
  sonarcloud:
    organization: "pow25-github" # the key of the org you chose at step #3
#    token:
#      secure: sZbJ89c08BsRWUydTYQaEq+rH9ngLfiuMHQ0U4/zbgnyeyS6JnXOcDjL1072pHtZlpFlM/atVAdt4A0WQZ923WseEPPj2oC47dTm/stAcVEpQ4YvmIrlSxxKWQ+MLB734P9n4sZ54YULN1wfvJYUg0NFdWAsLikU+uf2kgGQr+dTXJpxHK1rugxh87FTZhsfxE3adHa+04cR42kDj3AR1zXwKONoSC3SExYrPNj6KpfpAKZbnc6qII6naUIuqxTbYH7r+gvfyqbhvru5Cg0LlxUINyu/eMc4Je9xlyNrEwylPH06kIi2GpMpf9NFAvphRn1aNGKxjxWqKMkbP0Sho8zHGuP1JVzHhWnSlVFf6yknJ/i9pZ4B9AapHADvE6DYQwUewIk+VWUuC3hXCihjy6leyA6CeZ7h4mSYjdW8nqZzkMKhCgX5Ue1zFcd9Xii0DYwsjOzJhuOo5DDPjL4a/G1dUWDTr4SiZm9OIyFgou8c6TfDWNwHl/5jU19vpdVlYwrnpLRrs0Cb0jUy+1AxGjrZ37URJslOO+IaTYzH5cpAwKL5geTVaCXYxGZ1+YAOk83GPUCeDsd2j4tw0/p3rabtGj4ikAAgcIF9YGQ5/adIttwUOctkei8zU/jN76PvnbcqXLmNqtx1b8VIApiaZVhUZ9vPfelCscDHpfaEsSY=
script:
  # other script steps might be done before running the actual analysis
  #- sonar-scanner
  #- mvn clean org.jacoco:jacoco-maven-plugin:prepare-agent install sonar:sonar
  - mvn clean install sonar:sonar
  
services:
  - mysql
before_install:
  # Enter into MySQL using "root" user identified by password
  -mysql -u root --password=""

  #Create the database
  -mysql CREATE DATABASE vergilplus

  #Create the user
  -mysql CREATE USER 'newuser'@'localhsot' IDENTIFIED BY 'newpass'

  #Grant ALL privileges onthe new database to the new User
  -mysql GRANT ALL PRIVILEGES ON NEWDB.* TO 'dbuser'@'localhost' IDENTIFIED BY 'dbuser'

  #Switch to the New Database
  -mysql USE vergilplus;

  #Insert data from source.sql
  -mysql SOURCE ./data/vergilplus.sql